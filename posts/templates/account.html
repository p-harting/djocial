{% extends "base.html" %}

{% block content %}
<div class="account-container">
    <h1 class="account-username">{{ user_account.username }}</h1>

    {% if is_own_account %}
    <form method="post" class="account-form">
        {% csrf_token %}

        <!-- Email Update Section -->
        <h3 class="form-title">Update Email</h3>
        <input type="email" name="email" value="{{ user_account.email }}" placeholder="New email" class="form-control">
        <button type="submit" name="email_form" class="btn-primary">Update Email</button>

        <!-- Password Update Section -->
        <h3 class="form-title">Change Password</h3>
        {{ password_form.as_p }}
        <button type="submit" name="password_form" class="btn-primary">Change Password</button>
    </form>
    {% else %}
    <div class="follow-info">
        <h3 class="follow-count">Follower: {{ follower_count }}</h3>
        <h3 class="follow-count">Following: {{ following_count }}</h3>
    </div>

    <form method="post" action="{% url 'follow_toggle' user_account.pk %}" class="follow-form">
        {% csrf_token %}
        {% if is_following %}
        <button class="btn-danger" type="submit">Unfollow</button>
        {% else %}
        <button class="btn-primary" type="submit">Follow</button>
        {% endif %}
    </form>
    {% endif %}

    <h2 class="recent-posts-title">Recent Posts:</h2>
    {% for post in posts %}
    <div class="post-container no-underline-link">
        <p class="post-header"><strong>Author:</strong> {{ post.author }} | <strong>Date:</strong> {{ post.created_on|date:"d M Y H:i" }}</p>
        <p class="post-content">{{ post.content|safe|linebreaks }}</p>
        <div class="button-container">
            <a href="{% url 'post_detail' post.slug %}" class="view-post-button">View post</a>
        </div>
    </div>
    {% empty %}
    <p class="empty-state">Nothing posted yet.</p>
    {% endfor %}
</div>
{% endblock %}
